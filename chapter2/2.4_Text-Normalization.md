## 2.4 文本规范化（*Text Normalization*）

几乎在对文本进行任何自然语言处理之前，都必须对其进行规范化。作为任何规范化的一部分，通常至少有三项任务：

1. 分词（*Tokenizing (segmenting) words*）
2. 词格式（*word formats*）规范化
3. 分句

在接下来的章节中，我们将逐一讲解这些任务。

### 2.4.1 用于粗略分词和规范化的 Unix 工具

让我们从一个简单、有点幼稚的针对英语的分词和规范化（和频率计算）版本开始，该版本受到 Church(1994)[^1] 启发，可以只使用一个 UNIX 命令完成。我们将使用一些 Unix 命令：`tr`，用于改变输入中的特定字符；`sort`，按字母顺序对输入行进行排序；`uniq`，统计（*collapse and count*）文本文件中相邻且相同的行。

例如，让我们从一个包含 Shakespeare “完整单词”（*complete words*）的文本文件 `sh.txt` 开始（*译者注：应该是指 Shakespeare 所有作品文本都放在一行，然后该行放入 `sh.txt` 中*）。我们可以使用 `tr` 将每个非字母字符序列改为换行来进行分词（“A-Za-z”表示字母，`-c` 选项表示反选，即非字母，`-s` 选项将所有重复序列压缩为一个字符）：

```bash
tr -sc 'A-Za-z' '\n' < sh.txt
```

该命令的输出如下：

```
THE
SONNETS
by
William
Shakespeare
From
fairest
creatures
We
...
```

现在每行只有一个单词，我们可以对这些行进行排序，并将结果传递给 `uniq -c` 进行统计（*译者注：每列旁边显示该行重复出现的次数*）：

```bash
tr -sc 'A-Za-z' '\n' < sh.txt | sort | uniq -c
```

命令输出如下：

```
1945 A
72 AARON
19 ABBESS
25 Aaron
6 Abate
1 Abates
5 Abbess
6 Abbey
3 Abbot
...
```

另外，我们也可以先把所有的大写字母转成小写字母：

```bash
tr -sc 'A-Za-z' '\n' < sh.txt | tr A-Z a-z | sort | uniq -c
```

命令输出为：

```
14725 a
97 aaron
1 abaissiez
10 abandon
2 abandoned
2 abase
1 abash
14 abate
3 abated
3 abatement
...
```

现在我们可以再进行排序，找到经常出现的词。`sort` 的 `-n` 选项意味着按数字而不是按字母排序，而 `-r` 选项意味着按相反的顺序排序（从高到低）：

```bash
tr -sc 'A-Za-z' '\n' < sh.txt | tr A-Z a-z | sort | uniq -c | sort -n -r
```

结果表明，与其他语料库一样，Shakespeare 中出现频率最高的词是冠词（*articles*）、代词（*pronouns*）和介词（*prepositions*）等短**虚词**（*function words*）：

```
27378 the
26084 and
22538 i
19771 to
17481 of
14725 a
13826 you
12489 my
11318 that
11112 in
...
```

这类 Unix 工具在为任何语料库快速建立字数统计时都非常方便。

### 2.4.2 分词（*Word Tokenization*）

以上简单的 UNIX 工具对于获得粗略的单词统计是没有问题的，但是对于分词，也就是将文本分割成一个个词的任务，一般需要更复杂的分词算法。

Unix 命令过滤了所有的数字和标点符号，但对于大多数 NLP 应用来说，我们需要在分词任务中保留这些字符。我们往往想把标点符号视作一个单独词；对于解析器来说，逗号是一个有用的信息。句号有助于指示句子的边界。但我们有时会想保留词内部的标点符号，例如 *m.p.h*、*Ph.D.*、*AT&T* 和 *cap'n*。价格（$45.55）和日期（`01/02/06`）中的特殊字符和数字也需要保留；我们不想把这个价格分成“45”和“55”。还有网址（`http://www.stanford.edu`）、推特标签（`#nlproc`）和电子邮件地址（`someone@cs.colorado.edu`）。

数字也会带来其他复杂的问题；逗号通常是单词的边界，但在英语中，逗号也会用在数字内部，每三位数有一个逗号：`555,500.50`。不同语言对分词的要求也不一样，许多欧洲大陆的语言，如西班牙语、法语和德语，则用逗号来标记小数点，英语放逗号的地方则用空格（有时也用句号），例如：`555 500,50`。

[^1]: Church, K. W. (1994). Unix for Poets. Slides from 2nd ELSNET Summer School and unpublished paper ms.
